# =============================================================================
# KiteAPI Trading Rules v2.0
# =============================================================================
#
# HOW IT WORKS:
# 1. You place orders via Kite Web/App
# 2. Engine auto-detects your positions from account
# 3. Positions are matched to rules by symbol pattern
# 4. When TP/SL triggers, exit order is placed automatically
#
# RULES ONLY DEFINE EXIT CONDITIONS - position details come from account
#
# =============================================================================

version: "2.0"

# Default exit conditions (applied when no specific rule matches)
defaults:
  enabled: false
  take_profit:
    condition_type: percentage
    target: 20
  stop_loss:
    condition_type: percentage
    stop: 10

# Default time conditions for all rules
default_time_conditions:
  start_time: "09:15"
  end_time: "15:15"
  square_off_time: "15:20"
  active_days: [0, 1, 2, 3, 4]  # Mon-Fri

# =============================================================================
# EXIT RULES
# =============================================================================
# 
# symbol_pattern supports:
#   - Exact match: "SENSEX24N2779000CE"
#   - Wildcards: "SENSEX*CE" (any SENSEX call), "NIFTY*" (any NIFTY)
#   - Regex: "^SENSEX.*CE$"
#
# condition_type:
#   - relative: points from entry (+100 = entry + 100)
#   - percentage: percent of entry (+20 = entry * 1.20)
#   - absolute: fixed price level (800 = exit at 800)
#
# =============================================================================

rules:
  # ---------------------------------------------------------------------------
  # SENSEX Options - All calls and puts
  # ---------------------------------------------------------------------------
  - rule_id: "sensex-options"
    name: "SENSEX Options"
    symbol_pattern: "SENSEX*"
    exchange: "BFO"
    apply_to: "ALL"  # LONG, SHORT, or ALL
    
    take_profit:
      enabled: true
      condition_type: relative
      target: 100        # +100 points
      order_type: MARKET
      trail: false
    
    stop_loss:
      enabled: true
      condition_type: relative
      stop: 40         # -50 points
      order_type: MARKET
      trail: false
    
    tags: ["options", "index"]

  # ---------------------------------------------------------------------------
  # NIFTY Options - Percentage based
  # ---------------------------------------------------------------------------
  - rule_id: "nifty-options"
    name: "NIFTY Options"
    symbol_pattern: "NIFTY*"
    exchange: "NFO"
    
    take_profit:
      enabled: true
      condition_type: percentage
      target: 30         # +30%
      order_type: MARKET
    
    stop_loss:
      enabled: true
      condition_type: percentage
      stop: 20           # -20%
      order_type: MARKET
    
    tags: ["options", "nifty"]

  # ---------------------------------------------------------------------------
  # BANKNIFTY Options
  # ---------------------------------------------------------------------------
  - rule_id: "banknifty-options"
    name: "BANKNIFTY Options"
    symbol_pattern: "BANKNIFTY*"
    exchange: "NFO"
    
    take_profit:
      enabled: true
      condition_type: percentage
      target: 25
      order_type: MARKET
    
    stop_loss:
      enabled: true
      condition_type: percentage
      stop: 15
      order_type: MARKET
    
    tags: ["options", "banknifty"]

  # ---------------------------------------------------------------------------
  # Equity Futures - Trailing SL
  # ---------------------------------------------------------------------------
  - rule_id: "equity-futures"
    name: "Equity Futures"
    symbol_pattern: "*FUT"
    exchange: "NFO"
    
    take_profit:
      enabled: false     # No fixed TP, let it run
      condition_type: percentage
      target: 5
      order_type: MARKET
    
    stop_loss:
      enabled: true
      condition_type: percentage
      stop: 2
      order_type: MARKET
      trail: true        # Trailing SL
      trail_step: 1.5    # Trail by 1.5%
    
    tags: ["futures"]
    notes: "Trailing SL for futures"
